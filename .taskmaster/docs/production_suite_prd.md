# Rhino Production Suite - Product Requirements Document (PRD)

## 1. Vision & Overview

To create a comprehensive production and organization plugin for Rhino 8 on Windows. This suite will streamline the workflow for CNC manufacturing by providing two core, integrated tools: a **Material Management Palette** and an **Element Organization Outliner**. The ultimate goal is to create a robust data foundation that a future AI-powered CNC automation engine (`RhinoAI`) can leverage.

---

## 2. Core Components & UI

The plugin will consist of two main, independent panels that are dockable, floatable, and lockable within the Rhino 8 workspace. The UI will be built using **WPF** for a modern, responsive, and feature-rich experience.

### 2.1. Material Palette
A fast, project-specific panel for managing materials.

*   **Global Material Catalog**:
    *   A persistent, centralized database (`materials.json`) storing all company-approved materials.
    *   Accessible via a dedicated "Material Catalog" window.
    *   Users can add, edit, and delete materials from this global library.
*   **Project Material Palette**:
    *   A dockable panel showing materials currently used in the active project.
    *   `[+] Add from Catalog` button opens a dialog to import materials from the Global Catalog into the current project.
*   **Core Functions**:
    *   **Assign Material**: Assigns the selected material from the palette to selected Rhino objects by writing data to their user attributes.
    *   **Select by Material**: Selects all objects in the document that have the chosen material assigned.
    *   **Hide by Material**: Hides all objects in the document with the chosen material.
    *   **Get Sheet Layout**: Creates a rectangle in the viewport representing the material's maximum sheet size.
    *   **Remove from Project**: Removes a material from the project palette (does not delete from the Global Catalog).

### 2.2. Element Outliner
An advanced block manager for organizing, documenting, and preparing parts for production.

*   **Outliner Panel**:
    *   A dockable, tree-view panel listing all "Elements" (specialized Rhino blocks) in the document.
    *   Displays a clear hierarchy of nested elements.
*   **Core Functions**:
    *   **Create Element**: Groups selected Rhino objects into a new Element (block).
    *   **Select / Hide / Isolate**: Standard object management for elements directly from the outliner.
    *   **Batch Rename**: Allows for powerful, pattern-based renaming of multiple elements at once.
    *   **Attach Documentation**: A key feature allowing users to link external files (PDFs, DXFs, STEP files, images) directly to an Element. These files are stored as metadata on the block definition.
    *   **Preview Contents**: A tooltip or sub-panel showing the objects contained within an element.

---

## 3. Data Schema & Persistence

### 3.1. Material Data
Each material in the `materials.json` catalog will be a JSON object with the following schema:
*   `id` (string, UUID)
*   `name` (string, e.g., "MDF Black")
*   `type` (enum string: "Sheet", "Length")
*   `thickness` (number, in mm)
*   `sheet_width` (number, in mm, for "Sheet" type)
*   `sheet_height` (number, in mm, for "Sheet" type)
*   `weight` (number, optional, kg/mÂ² or kg/m)

**Example:**
```json
{
  "id": "c4d2c6c0-6e4b-4b2d-8b0a-9e1e2e1c9e1e",
  "name": "MDF 18mm",
  "type": "Sheet",
  "thickness": 18,
  "sheet_width": 1220,
  "sheet_height": 2440,
  "weight": 13.5
}
```

### 3.2. Element Data
*   Object-to-material assignments will be stored in the Rhino object's **User Attributes**. The key will be `cnc.material.id` and the value will be the material's UUID.
*   Element file attachments will be stored in the **Block Definition's User Attributes**. The key will be `cnc.element.docs` and the value will be a JSON string representing an array of file paths.

---

## 4. Technical Stack & Implementation

*   **Language**: C#
*   **Framework**: .NET
*   **UI**: WPF (Windows Presentation Foundation)
*   **Target Environment**: Rhino 8 on Windows 11
*   **Database**: A simple `materials.json` file stored in a user-accessible location (e.g., `AppData` or `My Documents`) to ensure persistence across projects and Rhino sessions.

---

## 5. Non-Functional Requirements

*   **Performance**: The UI must be highly responsive and not lag, even with hundreds of materials or elements.
*   **Usability**: The workflow must be intuitive for a Rhino user. Locking the palette position is a key requirement.
*   **Extensibility**: The system architecture should allow for the future integration of the `RhinoAI` engine, which will consume the data generated by this plugin. 